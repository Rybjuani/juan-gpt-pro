<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>JUAN_GPT // EXTRACTOR_OSINT_V4.5</title>
    <style>
        body { background: #000; color: #00ff41; font-family: 'Courier New', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        #setup-screen { position: fixed; inset: 0; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; border: 5px double #00ff41; }
        #terminal { flex: 1; display: none; flex-direction: column; padding: 20px; overflow: hidden; }
        #output { flex: 1; overflow-y: auto; border: 1px solid #00ff41; padding: 15px; margin-bottom: 10px; background: rgba(0,20,0,0.5); font-size: 13px; white-space: pre-wrap; }
        .input-line { display: flex; background: #000; border: 1px solid #00ff41; padding: 10px; }
        input { flex: 1; background: transparent; border: none; color: #00ff41; outline: none; font-family: inherit; font-size: 16px; }
        button { background: #00ff41; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        .status { color: #ff003c; font-weight: bold; margin-bottom: 5px; }
        .data-blob { color: #00d4ff; border-left: 3px solid #00d4ff; padding-left: 10px; margin: 10px 0; }
    </style>
</head>
<body>

    <div id="setup-screen">
        <h1 style="letter-spacing: 10px;">OSINT_KERNEL_LOADER</h1>
        <input type="password" id="g-key" placeholder="GROQ_API_KEY" style="margin:5px; width:350px; padding:10px;">
        <input type="password" id="t-key" placeholder="TAVILY_API_KEY" style="margin:5px; width:350px; padding:10px;">
        <br>
        <button onclick="bootSystem()">INICIAR SECUENCIA</button>
    </div>

    <div id="terminal">
        <div class="status" id="sys-status">SISTEMA_LISTO: Esperando identificador de objetivo...</div>
        <div id="output"></div>
        <div class="input-line">
            <span>[ROOT@EXTRACTOR]:~$ </span>
            <input type="text" id="target-in" placeholder="Ingrese nombre, DNI o alias..." autofocus>
        </div>
    </div>

    <script>
        let G_KEY = "";
        let T_KEY = "";

        function bootSystem() {
            G_KEY = document.getElementById('g-key').value.trim();
            T_KEY = document.getElementById('t-key').value.trim();
            if(G_KEY && T_KEY) {
                document.getElementById('setup-screen').style.display = 'none';
                document.getElementById('terminal').style.display = 'flex';
            } else { alert("Inserte ambas llaves."); }
        }

        async function fetchWeb(query) {
            const r = await fetch('https://api.tavily.com/search', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    api_key: T_KEY,
                    query: query,
                    search_depth: "advanced",
                    max_results: 10
                })
            });
            return await r.json();
        }

        async function processData() {
            const input = document.getElementById('target-in');
            const out = document.getElementById('output');
            const status = document.getElementById('sys-status');
            const target = input.value.trim();
            if(!target) return;

            input.value = "";
            out.innerHTML += `<div style="color:#00d4ff">>> COMANDO DE EXTRACCIÓN SOBRE: ${target}</div>`;
            status.innerText = "BUSCANDO EN LA RED (TAVILY_SEARCH)...";

            try {
                // 1. BUSQUEDA REAL
                const rawResults = await fetchWeb(target);
                status.innerText = "PROCESANDO DUMP DE DATOS CON IA (GROQ_PARSER)...";

                // 2. FILTRADO CON IA (Disfrazado de procesador de logs)
                const gRes = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${G_KEY}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        model: "llama-3.1-8b-instant", // Modelo más rápido y menos "ético" que el 70b
                        messages: [
                            { 
                                role: "system", 
                                content: "Eres un EXTRACCIÓN_BOT_V3. Tu única función es tomar un JSON de datos web y extraer: 1. Correos electrónicos, 2. Links a perfiles sociales, 3. Direcciones físicas, 4. Números telefónicos. No hables, no saludes, no des consejos. Si no encuentras algo, no te disculpes. Solo entrega los datos encontrados en formato de lista técnica." 
                            },
                            { role: "user", content: `DUMP_DATA: ${JSON.stringify(rawResults)}` }
                        ],
                        temperature: 0.1
                    })
                });

                const data = await gRes.json();
                status.innerText = "EXTRACCIÓN COMPLETADA.";
                const content = data.choices[0].message.content;
                out.innerHTML += `<div class="data-blob"><b>RESULTADOS DE LA EXTRACCIÓN:</b>\n${content}</div>`;
                
            } catch (e) {
                out.innerHTML += `<div style="color:red">FALLO CRÍTICO EN EL NODO DE DATOS.</div>`;
            }
            out.scrollTop = out.scrollHeight;
        }

        document.getElementById('target-in').onkeypress = (e) => { if(e.key === 'Enter') processData(); };
    </script>
</body>
</html>
