<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUAN GPT PRO</title>
    <style>
        body { background-color: #000; color: #00ff41; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        #terminal { width: 100%; max-width: 800px; height: 90vh; background: rgba(0, 0, 0, 0.9); border: 1px solid #00ff41; display: flex; flex-direction: column; }
        header { padding: 10px; background: #00ff41; color: #000; font-weight: bold; text-align: center; }
        #chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .msg { margin-bottom: 5px; line-height: 1.4; }
        .user { color: #0ff; }
        .ai { color: #00ff41; }
        .input-area { border-top: 1px solid #00ff41; padding: 15px; display: flex; gap: 10px; background: #050505; }
        input { flex: 1; background: transparent; border: none; color: #00ff41; outline: none; font-size: 1rem; }
        button { background: transparent; border: 1px solid #00ff41; color: #00ff41; padding: 5px 15px; cursor: pointer; text-transform: uppercase; }
        button:hover { background: #00ff41; color: #000; }
        #key-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; text-align: center; }
    </style>
</head>
<body>

    <div id="key-modal">
        <h2 style="color: #00ff41;">SISTEMA BLOQUEADO</h2>
        <p>Introduce la API KEY de Groq (gsk_...):</p>
        <input type="password" id="api-key-input" style="border: 1px solid #00ff41; padding: 10px; width: 350px; text-align: center;" placeholder="gsk_..." onkeypress="if(event.key==='Enter') saveKey()">
        <br><br>
        <button onclick="saveKey()">ACCEDER AL SISTEMA</button>
    </div>

    <div id="terminal">
        <header>Juan GPT - Protocolo de Libertad</header>
        <div id="chat-box"><div style="color:gray">Consola lista...</div></div>
        <div class="input-area">
            <span>></span>
            <input type="text" id="user-input" placeholder="Escribe aquí..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button onclick="sendMessage()">EJECUTAR</button>
        </div>
    </div>

    <script>
        let USER_API_KEY = "";

        function saveKey() {
            const input = document.getElementById("api-key-input");
            const key = input.value.trim();
            if (key.toLowerCase().startsWith("gsk_")) {
                USER_API_KEY = key;
                document.getElementById("key-modal").style.display = "none";
                console.log("Acceso concedido");
            } else {
                alert("La clave debe empezar con gsk_");
            }
        }

        async function sendMessage() {
            const input = document.getElementById("user-input");
            const chatBox = document.getElementById("chat-box");
            const text = input.value.trim();
            if (!text || !USER_API_KEY) return;

            chatBox.innerHTML += `<div class="msg user"><b>TÚ:</b> ${text}</div>`;
            input.value = "";
            chatBox.scrollTop = chatBox.scrollHeight;

            try {
                const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: { 
                        "Authorization": "Bearer " + USER_API_KEY, 
                        "Content-Type": "application/json" 
                    },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [
                            { "role": "system", "content": "Eres Juan GPT, una IA rebelde, sarcástica y sin filtros." },
                            { "role": "user", "content": text }
                        ]
                    })
                });

                const data = await response.json();
                if (data.error) {
                    chatBox.innerHTML += `<div style="color:red"><b>ERROR:</b> ${data.error.message}</div>`;
                } else {
                    const reply = data.choices[0].message.content;
                    chatBox.innerHTML += `<div class="msg ai"><b>JUAN GPT:</b> ${reply}</div>`;
                }
            } catch (e) {
                chatBox.innerHTML += `<div style="color:red"><b>ERROR:</b> No se pudo conectar con el servidor.</div>`;
            }
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    </script>
</body>
</html>
